var plugin=function(exports){"use strict";function noop(){}function assign(e,t){for(const n in t)e[n]=t[n];return e}function run(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run)}function is_function(e){return"function"==typeof e}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function is_empty(e){return 0===Object.keys(e).length}function subscribe(e,...t){if(null==e){for(const e of t)e(void 0);return noop}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function component_subscribe(e,t,n){e.$$.on_destroy.push(subscribe(t,n))}function create_slot(e,t,n,o){if(e){const r=get_slot_context(e,t,n,o);return e[0](r)}}function get_slot_context(e,t,n,o){return e[1]&&o?assign(n.ctx.slice(),e[1](o(t))):n.ctx}function get_slot_changes(e,t,n,o){return e[2],t.dirty}function update_slot_base(e,t,n,o,r,c){if(r){const s=get_slot_context(t,n,o,c);e.p(s,r)}}function get_all_dirty_from_scope(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function exclude_internal_props(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function action_destroyer(e){return e&&is_function(e.destroy)?e.destroy:noop}function append(e,t){e.appendChild(t)}function append_styles(e,t,n){const o=get_root_for_style(e);if(!o.getElementById(t)){const e=element("style");e.id=t,e.textContent=n,append_stylesheet(o,e)}}function get_root_for_style(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function append_stylesheet(e,t){return append(e.head||e,t),t.sheet}function insert(e,t,n){e.insertBefore(t,n||null)}function detach(e){e.parentNode&&e.parentNode.removeChild(e)}function element(e){return document.createElement(e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function empty(){return text("")}function listen(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function attr(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function children(e){return Array.from(e.childNodes)}function set_data(e,t){t=""+t,e.data!==t&&(e.data=t)}let current_component;function set_current_component(e){current_component=e}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(e){get_current_component().$$.on_mount.push(e)}function onDestroy(e){get_current_component().$$.on_destroy.push(e)}function getContext(e){return get_current_component().$$.context.get(e)}const dirty_components=[],binding_callbacks=[];let render_callbacks=[];const flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(e){render_callbacks.push(e)}const seen_callbacks=new Set;let flushidx=0;function flush(){if(0!==flushidx)return;const e=current_component;do{try{for(;flushidx<dirty_components.length;){const e=dirty_components[flushidx];flushidx++,set_current_component(e),update(e.$$)}}catch(e){throw dirty_components.length=0,flushidx=0,e}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let e=0;e<render_callbacks.length;e+=1){const t=render_callbacks[e];seen_callbacks.has(t)||(seen_callbacks.add(t),t())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(e)}function update(e){if(null!==e.fragment){e.update(),run_all(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(add_render_callback)}}function flush_render_callbacks(e){const t=[],n=[];render_callbacks.forEach(o=>-1===e.indexOf(o)?t.push(o):n.push(o)),n.forEach(e=>e()),render_callbacks=t}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(e,t){e&&e.i&&(outroing.delete(e),e.i(t))}function transition_out(e,t,n,o){if(e&&e.o){if(outroing.has(e))return;outroing.add(e),outros.c.push(()=>{outroing.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function get_spread_update(e,t){const n={},o={},r={$$scope:1};let c=e.length;for(;c--;){const s=e[c],i=t[c];if(i){for(const e in s)e in i||(o[e]=1);for(const e in i)r[e]||(n[e]=i[e],r[e]=1);e[c]=i}else for(const e in s)r[e]=1}for(const e in o)e in n||(n[e]=void 0);return n}function get_spread_object(e){return"object"==typeof e&&null!==e?e:{}}function create_component(e){e&&e.c()}function mount_component(e,t,n){const{fragment:o,after_update:r}=e.$$;o&&o.m(t,n),add_render_callback(()=>{const t=e.$$.on_mount.map(run).filter(is_function);e.$$.on_destroy?e.$$.on_destroy.push(...t):run_all(t),e.$$.on_mount=[]}),r.forEach(add_render_callback)}function destroy_component(e,t){const n=e.$$;null!==n.fragment&&(flush_render_callbacks(n.after_update),run_all(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function make_dirty(e,t){-1===e.$$.dirty[0]&&(dirty_components.push(e),schedule_update(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function init(e,t,n,o,r,c,s=null,i=[-1]){const a=current_component;set_current_component(e);const l=e.$$={fragment:null,ctx:[],props:c,update:noop,not_equal:r,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:blank_object(),dirty:i,skip_bound:!1,root:t.target||a.$$.root};s&&s(l.root);let u=!1;if(l.ctx=n?n(e,t.props||{},(t,n,...o)=>{const c=o.length?o[0]:n;return l.ctx&&r(l.ctx[t],l.ctx[t]=c)&&(!l.skip_bound&&l.bound[t]&&l.bound[t](c),u&&make_dirty(e,t)),n}):[],l.update(),u=!0,run_all(l.before_update),l.fragment=!!o&&o(l.ctx),t.target){if(t.hydrate){const e=children(t.target);l.fragment&&l.fragment.l(e),e.forEach(detach)}else l.fragment&&l.fragment.c();t.intro&&transition_in(e.$$.fragment),mount_component(e,t.target,t.anchor),flush()}set_current_component(a)}class SvelteComponent{$$=void 0;$$set=void 0;$destroy(){destroy_component(this,1),this.$destroy=noop}$on(e,t){if(!is_function(t))return noop;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!is_empty(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const PUBLIC_VERSION="4";function add_css$1(e){append_styles(e,"svelte-1x6hpug",".injecteur-code-container.svelte-1x6hpug{display:block;min-height:80px;position:relative;box-sizing:border-box}.html-content.svelte-1x6hpug{width:100%;min-height:20px}.placeholder.svelte-1x6hpug{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:30px 20px;border:2px dashed #4CAF50;border-radius:8px;background:#f9fff9;text-align:center;min-height:80px}.placeholder-icon.svelte-1x6hpug{font-size:32px;margin-bottom:10px}.placeholder-title.svelte-1x6hpug{font-size:14px;font-weight:600;color:#333;margin-bottom:8px}.placeholder-hint.svelte-1x6hpug{font-size:12px;color:#666;max-width:300px}.execute-button.svelte-1x6hpug{background:#4CAF50;color:white;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;font-size:14px;font-weight:bold;margin-bottom:10px;transition:background 0.3s}.execute-button.svelte-1x6hpug:hover{background:#45a049}.execute-button.svelte-1x6hpug:active{background:#3d8b40}")}function create_if_block_1(e){let t,n,o;return{c(){t=element("button"),t.textContent="‚ñ∂ Ex√©cuter le code",attr(t,"class","execute-button svelte-1x6hpug")},m(r,c){insert(r,t,c),n||(o=listen(t,"click",e[6]),n=!0)},p:noop,d(e){e&&detach(t),n=!1,o()}}}function create_else_block$1(e){let t;return{c(){t=element("div"),t.innerHTML='<div class="placeholder-icon svelte-1x6hpug">üìù</div> <div class="placeholder-title svelte-1x6hpug">Injecteur de code personnalis√©</div> <div class="placeholder-hint svelte-1x6hpug">Configurez le code HTML, CSS ou JavaScript dans les propri√©t√©s ‚Üí</div>',attr(t,"class","placeholder svelte-1x6hpug")},m(e,n){insert(e,t,n)},p:noop,d(e){e&&detach(t)}}}function create_if_block$1(e){let t;return{c(){t=element("div"),attr(t,"class","html-content svelte-1x6hpug")},m(n,o){insert(n,t,o),t.innerHTML=e[0]},p(e,n){1&n&&(t.innerHTML=e[0])},d(e){e&&detach(t)}}}function create_fragment$2(e){let t,n,o,r,c,s="onClick"===e[1]&&create_if_block_1(e);function i(e,t){return e[0]?create_if_block$1:create_else_block$1}let a=i(e),l=a(e);return{c(){t=element("div"),s&&s.c(),n=space(),l.c(),attr(t,"class","injecteur-code-container svelte-1x6hpug")},m(i,a){insert(i,t,a),s&&s.m(t,null),append(t,n),l.m(t,null),e[12](t),r||(c=action_destroyer(o=e[5].call(null,t,e[3].styles)),r=!0)},p(e,[r]){"onClick"===e[1]?s?s.p(e,r):(s=create_if_block_1(e),s.c(),s.m(t,n)):s&&(s.d(1),s=null),a===(a=i(e))&&l?l.p(e,r):(l.d(1),l=a(e),l&&(l.c(),l.m(t,null))),o&&is_function(o.update)&&8&r&&o.update.call(null,e[3].styles)},i:noop,o:noop,d(n){n&&detach(t),s&&s.d(),l.d(),e[12](null),r=!1,c()}}}function instance$2($$self,$$props,$$invalidate){let $component,{htmlCode:htmlCode=""}=$$props,{cssCode:cssCode=""}=$$props,{jsCode:jsCode=""}=$$props,{executionMode:executionMode="onMount"}=$$props,{intervalTime:intervalTime=1e3}=$$props,{sandboxMode:sandboxMode=!1}=$$props;const component=getContext("component");component_subscribe($$self,component,e=>$$invalidate(3,$component=e));const{styleable:styleable,notificationStore:notificationStore}=getContext("sdk");let containerElement,styleElement,intervalId,hasExecuted=!1;function executeJavaScript(){if(jsCode.trim())try{if(sandboxMode){const e=new Function("component","context",jsCode);e(component,getContext)}else eval(jsCode);notificationStore?.actions?.success("Code JavaScript ex√©cut√© avec succ√®s")}catch(e){console.error("Erreur d'ex√©cution JavaScript:",e),notificationStore?.actions?.error(`Erreur JavaScript: ${e.message}`)}}function injectCSS(){cssCode.trim()&&(styleElement&&styleElement.remove(),styleElement=document.createElement("style"),styleElement.innerHTML=cssCode,document.head.appendChild(styleElement))}function executeManually(){injectCSS(),executeJavaScript()}function div_binding(e){binding_callbacks[e?"unshift":"push"](()=>{containerElement=e,$$invalidate(2,containerElement)})}return onMount(()=>{injectCSS(),"onMount"===executionMode?(executeJavaScript(),$$invalidate(11,hasExecuted=!0)):"onInterval"===executionMode&&(intervalId=setInterval(()=>{executeJavaScript()},intervalTime))}),onDestroy(()=>{intervalId&&clearInterval(intervalId),styleElement&&styleElement.remove()}),$$self.$$set=e=>{"htmlCode"in e&&$$invalidate(0,htmlCode=e.htmlCode),"cssCode"in e&&$$invalidate(7,cssCode=e.cssCode),"jsCode"in e&&$$invalidate(8,jsCode=e.jsCode),"executionMode"in e&&$$invalidate(1,executionMode=e.executionMode),"intervalTime"in e&&$$invalidate(9,intervalTime=e.intervalTime),"sandboxMode"in e&&$$invalidate(10,sandboxMode=e.sandboxMode)},$$self.$$.update=()=>{128&$$self.$$.dirty&&cssCode&&injectCSS(),2306&$$self.$$.dirty&&jsCode&&"onMount"===executionMode&&!hasExecuted&&(executeJavaScript(),$$invalidate(11,hasExecuted=!0))},[htmlCode,executionMode,containerElement,$component,component,styleable,executeManually,cssCode,jsCode,intervalTime,sandboxMode,hasExecuted,div_binding]}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add(PUBLIC_VERSION);let Component$1=class extends SvelteComponent{constructor(e){super(),init(this,e,instance$2,create_fragment$2,safe_not_equal,{htmlCode:0,cssCode:7,jsCode:8,executionMode:1,intervalTime:9,sandboxMode:10},add_css$1)}};function add_css(e){append_styles(e,"svelte-e9rmbi",".error-boundary.svelte-e9rmbi.svelte-e9rmbi{padding:20px;background:#fee;border:1px solid #fcc;border-radius:4px;color:#c00}.error-boundary.svelte-e9rmbi pre.svelte-e9rmbi{margin-top:10px;font-size:12px;white-space:pre-wrap}")}function create_else_block(e){let t;const n=e[2].default,o=create_slot(n,e,e[1],null);return{c(){o&&o.c()},m(e,n){o&&o.m(e,n),t=!0},p(e,r){o&&o.p&&(!t||2&r)&&update_slot_base(o,n,e,e[1],t?get_slot_changes(n,e[1],r,null):get_all_dirty_from_scope(e[1]),null)},i(e){t||(transition_in(o,e),t=!0)},o(e){transition_out(o,e),t=!1},d(e){o&&o.d(e)}}}function create_if_block(e){let t,n,o,r,c,s=e[0].message+"";return{c(){t=element("div"),n=element("p"),n.textContent="Une erreur s'est produite dans le composant",o=space(),r=element("pre"),c=text(s),attr(r,"class","svelte-e9rmbi"),attr(t,"class","error-boundary svelte-e9rmbi")},m(e,s){insert(e,t,s),append(t,n),append(t,o),append(t,r),append(r,c)},p(e,t){1&t&&s!==(s=e[0].message+"")&&set_data(c,s)},i:noop,o:noop,d(e){e&&detach(t)}}}function create_fragment$1(e){let t,n,o,r;const c=[create_if_block,create_else_block],s=[];function i(e,t){return e[0]?0:1}return t=i(e),n=s[t]=c[t](e),{c(){n.c(),o=empty()},m(e,n){s[t].m(e,n),insert(e,o,n),r=!0},p(e,[r]){let a=t;t=i(e),t===a?s[t].p(e,r):(group_outros(),transition_out(s[a],1,1,()=>{s[a]=null}),check_outros(),n=s[t],n?n.p(e,r):(n=s[t]=c[t](e),n.c()),transition_in(n,1),n.m(o.parentNode,o))},i(e){r||(transition_in(n),r=!0)},o(e){transition_out(n),r=!1},d(e){e&&detach(o),s[t].d(e)}}}function instance$1(e,t,n){let{$$slots:o={},$$scope:r}=t,c=null;return onMount(()=>{const e=e=>{console.error("Plugin error:",e.error),n(0,c=e.error)};return window.addEventListener("error",e),()=>{window.removeEventListener("error",e)}}),e.$$set=e=>{"$$scope"in e&&n(1,r=e.$$scope)},[c,r,o]}class Boundary extends SvelteComponent{constructor(e){super(),init(this,e,instance$1,create_fragment$1,safe_not_equal,{},add_css)}}function create_default_slot_1(e){let t;const n=e[1].default,o=create_slot(n,e,e[2],null);return{c(){o&&o.c()},m(e,n){o&&o.m(e,n),t=!0},p(e,r){o&&o.p&&(!t||4&r)&&update_slot_base(o,n,e,e[2],t?get_slot_changes(n,e[2],r,null):get_all_dirty_from_scope(e[2]),null)},i(e){t||(transition_in(o,e),t=!0)},o(e){transition_out(o,e),t=!1},d(e){o&&o.d(e)}}}function create_default_slot(e){let t,n;const o=[e[0]];let r={$$slots:{default:[create_default_slot_1]},$$scope:{ctx:e}};for(let e=0;e<o.length;e+=1)r=assign(r,o[e]);return t=new Component$1({props:r}),{c(){create_component(t.$$.fragment)},m(e,o){mount_component(t,e,o),n=!0},p(e,n){const r=1&n?get_spread_update(o,[get_spread_object(e[0])]):{};4&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function create_fragment(e){let t,n;return t=new Boundary({props:{$$slots:{default:[create_default_slot]},$$scope:{ctx:e}}}),{c(){create_component(t.$$.fragment)},m(e,o){mount_component(t,e,o),n=!0},p(e,[n]){const o={};5&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function instance(e,t,n){let{$$slots:o={},$$scope:r}=t;return e.$$set=e=>{n(0,t=assign(assign({},t),exclude_internal_props(e))),"$$scope"in e&&n(2,r=e.$$scope)},[t=exclude_internal_props(t),o,r]}class Wrapper extends SvelteComponent{constructor(e){super(),init(this,e,instance,create_fragment,safe_not_equal,{})}}var type="component",metadata={},schema={name:"injecteur-code-personnalise",friendlyName:"Injecteur de code personnalis√©",description:"Permet d'injecter du code HTML, CSS et JavaScript personnalis√© dans votre application.\n\nCr√©√© par MEMORA Solutions - St√©phane Lapointe (stephane@memora.ca)\nhttps://memora.solutions\nVersion 1.0.0",icon:"Code",settings:[{type:"text",label:"Code HTML",key:"htmlCode",defaultValue:""},{type:"text",label:"Code CSS",key:"cssCode",defaultValue:""},{type:"text",label:"Code JavaScript",key:"jsCode",defaultValue:""},{type:"select",label:"Mode d'ex√©cution",key:"executionMode",defaultValue:"onMount",options:[{label:"Au chargement (onMount)",value:"onMount"},{label:"Au clic (onClick)",value:"onClick"},{label:"En intervalle (onInterval)",value:"onInterval"}]},{type:"number",label:"Intervalle (ms)",key:"intervalTime",defaultValue:1e3,min:100,max:6e4,showIf:{executionMode:"onInterval"}},{type:"boolean",label:"Mode sandbox (s√©curis√©)",key:"sandboxMode",defaultValue:!1}],requiredAncestors:[],legalDirections:["row","column"]},schema$1={type:type,metadata:metadata,schema:schema},version$1="1.0.0",pkg={version:version$1};if(window){const e={Component:Wrapper,schema:schema$1,version:pkg.version};window["##BUDIBASE_CUSTOM_COMPONENTS##"]||(window["##BUDIBASE_CUSTOM_COMPONENTS##"]=[]),window["##BUDIBASE_CUSTOM_COMPONENTS##"].push(e),window.registerCustomComponent&&window.registerCustomComponent(e)}const Component=Wrapper,version=pkg.version;return exports.Component=Component,exports.schema=schema$1,exports.version=version,exports}({});
